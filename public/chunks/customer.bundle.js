(window.webpackJsonp=window.webpackJsonp||[]).push([[87],{1203:function(t,e,s){"use strict";s.r(e);var a=s(0),o={created:function(){this.customerList(),this.getMembership()},data:function(){return{customers:{},search:"",memberExist:"",customer_type:"",form:new a.Form({type:"silver",customer_id:""}),memerships:""}},methods:{getMembership:function(){var t=this;axios.get("/api/get/membership/list").then((function(e){t.memerships=e.data.memberships}))},deleteMemebership:function(t){var e=this;axios.get("/api/remove/membership/"+t).then((function(t){console.log(t),"OK"==t.data.success&&(e.$toasted.show(t.data.message,{type:"success",position:"top-center",duration:3e3}),e.customerList(),e.getMembership())}))},addMembership:function(){var t=this;this.form.post("/api/apply/membership",{transformRequest:[function(t,e){return objectToFormData(t)}]}).then((function(e){console.log(e),"OK"==e.data.success&&(t.customerList(),t.getMembership(),t.$toasted.show(e.data.message,{type:"success",position:"top-center",duration:4e3}),t.$modal.hide("membership"),t.form.customer_id=""),"update"==e.data.success&&(t.$toasted.show(e.data.message,{type:"success",position:"top-center",duration:4e3}),t.customerList(),t.getMembership(),t.$modal.hide("membership"),t.form.customer_id="")}))},filterMembership:function(t){if(this.memerships.length>0){var e="none";return this.memerships.forEach((function(s){t==s.customer_id&&(e=s.type)})),e}},filterButtonText:function(t){var e=!1;if(this.memerships.length>0)return this.memerships.forEach((function(s){t==s.customer_id&&(e=!0)})),e},displayModal:function(t){var e=this;0!=t?(this.memerships.length>0&&this.memerships.forEach((function(s){s.customer_id==t&&(e.form.type=s.type)})),this.form.customer_id=t,this.$modal.show("membership")):alert("this customer isn't retail customer ")},customerList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;axios.get("/list/customer?page="+e).then((function(e){"SUCCESS"==e.data.status&&(t.customers=e.data.customers)})).catch((function(t){console.log(t)}))},searchData:function(){var t=this;this.search.length>=2?axios.get("/search/customer/"+this.search).then((function(e){"OK"==e.data.success&&(t.customers=e.data.customers,console.log(e))})):this.customerList()},exportData:function(){"all"==this.customer_type?window.open("/api/export/customers","_blank"):"retail"==this.customer_type?window.open("/api/export/retail/customers","_blank"):"wholesale"==this.customer_type?window.open("/api/customers/export/wholesale","_blank"):"officesale"==this.customer_type?window.open("/api/export//customers/officesale","_blank"):Swal.fire({title:" sorry :) something went wrong",icon:"error"})}},components:{HasError:a.HasError}},r=s(1),i=Object(r.a)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("admin-main"),t._v(" "),s("div",{staticClass:"content-wrapper"},[t._m(0),t._v(" "),s("section",{staticClass:"content"},[s("div",{staticClass:"container"},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-lg-11 col-md-11"},[s("div",{staticClass:"box box-primary"},[s("div",{staticClass:"box-header with-border"},[s("h3",{staticClass:"box-title"},[t._v("Customer table")]),t._v(" "),s("div",{staticClass:"row",staticStyle:{"margin-bottom":"5px","margin-top":"10px"}},[s("div",{staticClass:"col-md-3"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.customer_type,expression:"customer_type"}],staticClass:"form-control",on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.customer_type=e.target.multiple?s:s[0]},t.exportData]}},[s("option",{attrs:{disabled:"",value:""}},[t._v("\n                        Select export customer type\n                      ")]),t._v(" "),s("option",{attrs:{value:"all"}},[t._v("all customers")]),t._v(" "),s("option",{attrs:{value:"retail"}},[t._v("retail customers")]),t._v(" "),s("option",{attrs:{value:"wholesale"}},[t._v("wholeSale customers")]),t._v(" "),s("option",{attrs:{value:"officesale"}},[t._v("\n                        Export officeSale customers\n                      ")])])]),t._v(" "),s("div",{staticClass:"col-lg-3"}),t._v(" "),s("div",{staticClass:"col-md-4"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"form-control",attrs:{type:"text",placeholder:"customer name or 01xxxxxxxxx",id:""},domProps:{value:t.search},on:{keyup:t.searchData,input:function(e){e.target.composing||(t.search=e.target.value)}}})]),t._v(" "),t._m(1)])]),t._v(" "),s("div",{staticClass:"box-body"},[s("table",{staticClass:"table table-striped table-bordered table-hover"},[t._m(2),t._v(" "),s("tbody",t._l(t.customers.data,(function(e,a){return s("tr",{key:a},[s("td",{attrs:{scope:"row"}},[t._v(t._s(a+1))]),t._v(" "),s("td",[t._v(t._s(e.name))]),t._v(" "),s("td",[t._v(t._s(e.phone))]),t._v(" "),s("td",[t._v("\n                        "+t._s(e.customer_city?e.customer_city.name:"null")+"\n                      ")]),t._v(" "),s("td",[t._v(t._s(e.address))]),t._v(" "),s("td",[s("span",{staticClass:"badge"},[t._v("\n                          "+t._s(t.filterMembership(e.user_id))+"\n                        ")])]),t._v(" "),s("td",[1==t.filterButtonText(e.user_id)?s("div",[s("a",{staticClass:"btn btn-danger",on:{click:function(s){return t.deleteMemebership(e.user_id)}}},[t._v("\n                            Remove MemberShip\n                          ")]),t._v(" "),s("a",{staticClass:"btn btn-success",on:{click:function(s){return t.displayModal(e.user_id)}}},[t._v("\n                            Change MemberShip\n                          ")])]):s("a",{staticClass:"btn btn-success",on:{click:function(s){return t.displayModal(e.user_id)}}},[t._v("\n                          Add MemberShip\n                        ")])])])})),0)])]),t._v(" "),s("div",{staticClass:"box-footer"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-lg-4"},[s("pagination",{attrs:{data:t.customers,limit:3},on:{"pagination-change-page":t.customerList}})],1),t._v(" "),s("div",{staticClass:"col-lg-6 mt-1",staticStyle:{"margin-top":"25px","text-align":"right"}},[s("p",[t._v("\n                      Showing "),s("strong",[t._v(t._s(t.customers.from))]),t._v(" to\n                      "),s("strong",[t._v(t._s(t.customers.to))]),t._v(" of total\n                      "),s("strong",[t._v(t._s(t.customers.total))]),t._v(" entries\n                    ")])])])])])])])])])]),t._v(" "),s("modal",{attrs:{name:"membership",width:200,height:150}},[s("div",{staticClass:"card",staticStyle:{padding:"20px"}},[s("form",{on:{submit:function(e){return e.preventDefault(),t.addMembership(e)}}},[s("div",{staticClass:"card-body"},[s("div",{staticClass:"form-group"},[s("label",[t._v("Membership type")]),t._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.form.type,expression:"form.type"}],staticClass:"form-control",class:{"is-invalid":t.form.errors.has("type")},attrs:{name:"type",required:""},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.form,"type",e.target.multiple?s:s[0])}}},[s("option",{attrs:{value:"silver"}},[t._v("Silver")]),t._v(" "),s("option",{attrs:{value:"gold"}},[t._v("Gold")]),t._v(" "),s("option",{attrs:{value:"platinum"}},[t._v("Platinum")])]),t._v(" "),s("has-error",{attrs:{form:t.form,field:"type"}})],1),t._v(" "),s("div",{staticClass:"form-group text-center"},[s("input",{staticClass:"btn btn-success",attrs:{type:"submit",value:"apply"}})])])])])])],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("section",{staticClass:"content-header",staticStyle:{"margin-bottom":"20px"}},[e("h1"),this._v(" "),e("ol",{staticClass:"breadcrumb"},[e("li",[e("a",{attrs:{href:"#"}},[e("i",{staticClass:"fa fa-dashboard"}),this._v("Dashboard")])]),this._v(" "),e("li",{staticClass:"active"},[this._v("Customer")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-md-1",staticStyle:{"margin-left":"-23px"}},[e("button",{staticClass:"btn btn-success",attrs:{type:"submit"}},[this._v("\n                      search\n                    ")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",{attrs:{scope:"col"}},[t._v("#")]),t._v(" "),s("th",{attrs:{scope:"col"}},[t._v("Name")]),t._v(" "),s("th",{attrs:{scope:"col"}},[t._v("Phone")]),t._v(" "),s("th",{attrs:{scope:"col"}},[t._v("City")]),t._v(" "),s("th",{attrs:{scope:"col"}},[t._v("Address")]),t._v(" "),s("th",{attrs:{scope:"col"}},[t._v("Membership")]),t._v(" "),s("th",{attrs:{scope:"col"}},[t._v("Action")])])])}],!1,null,null,null);e.default=i.exports}}]);